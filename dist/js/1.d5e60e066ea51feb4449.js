webpackJsonp([1,14],{480:function(t,e,n){function o(t){n(546)}var a=n(16)(n(548),n(549),o,"data-v-7da23f5c",null);t.exports=a.exports},490:function(t,e,n){function o(t){n(603)}var a=n(16)(n(605),n(606),o,"data-v-d29dab06",null);t.exports=a.exports},498:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.regex=e.ref=e.len=e.req=e.withParams=void 0;var o=n(502),a=function(t){return t&&t.__esModule?t:{default:t}}(o);e.withParams=a.default;var r=e.req=function(t){if(Array.isArray(t))return!!t.length;if(void 0===t||null===t||!1===t)return!1;if("object"==typeof t){for(var e in t)return!0;return!1}return!!String(t).length};e.len=function(t){return Array.isArray(t)?t.length:"object"==typeof t?Object.keys(t).length:String(t).length},e.ref=function(t,e,n){return"function"==typeof t?t.call(e,n):n[t]},e.regex=function(t,e){return(0,a.default)({type:t},function(t){return!r(t)||e.test(t)})}},499:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.and=e.or=e.url=e.sameAs=e.requiredUnless=e.requiredIf=e.required=e.minLength=e.maxLength=e.email=e.between=e.numeric=e.alphaNum=e.alpha=void 0;var a=n(501),r=o(a),i=n(503),s=o(i),c=n(504),d=o(c),l=n(505),u=o(l),f=n(506),m=o(f),p=n(507),v=o(p),h=n(508),g=o(h),b=n(509),y=o(b),_=n(510),x=o(_),C=n(511),A=o(C),w=n(512),q=o(w),D=n(513),$=o(D),k=n(514),P=o(k),L=n(515),S=o(L);e.alpha=r.default,e.alphaNum=s.default,e.numeric=d.default,e.between=u.default,e.email=m.default,e.maxLength=v.default,e.minLength=g.default,e.required=y.default,e.requiredIf=x.default,e.requiredUnless=A.default,e.sameAs=q.default,e.url=$.default,e.or=P.default,e.and=S.default},500:function(t,e,n){var o=n(87),a=n(15)("toStringTag"),r="Arguments"==o(function(){return arguments}()),i=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=i(e=Object(t),a))?n:r?o(e):"Object"==(s=o(e))&&"function"==typeof e.callee?"Arguments":s}},501:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("alpha",/^[a-zA-Z]*$/)},502:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(259).withParams;e.default=o},503:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("alphaNum",/^[a-zA-Z0-9]*$/)},504:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("numeric",/^[0-9]*$/)},505:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t,e){return(0,o.withParams)({type:"between",min:t,max:e},function(n){return!(0,o.req)(n)||!/\s/.test(n)&&+t<=+n&&+e>=+n})}},506:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498),a=/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/;e.default=(0,o.regex)("email",a)},507:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"maxLength",max:t},function(e){return!(0,o.req)(e)||(0,o.len)(e)<=t})}},508:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"minLength",min:t},function(e){return!(0,o.req)(e)||(0,o.len)(e)>=t})}},509:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.withParams)({type:"required"},o.req)},510:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"requiredIf",prop:t},function(e,n){return!(0,o.ref)(t,this,n)||(0,o.req)(e)})}},511:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"requiredUnless",prop:t},function(e,n){return!!(0,o.ref)(t,this,n)||(0,o.req)(e)})}},512:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"sameAs",eq:t},function(e,n){return e===(0,o.ref)(t,this,n)})}},513:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498),a=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/;e.default=(0,o.regex)("url",a)},514:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.withParams)({type:"or"},function(){for(var t=this,n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return e.length>0&&e.reduce(function(e,n){return e||n.apply(t,o)},!1)})}},515:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.withParams)({type:"and"},function(){for(var t=this,n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return e.length>0&&e.reduce(function(e,n){return e&&n.apply(t,o)},!0)})}},516:function(t,e,n){var o=n(33);t.exports=function(t,e,n,a){try{return a?e(o(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&o(r.call(t)),e}}},517:function(t,e,n){var o=n(48),a=n(15)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||r[a]===t)}},518:function(t,e,n){var o=n(500),a=n(15)("iterator"),r=n(48);t.exports=n(32).getIteratorMethod=function(t){if(void 0!=t)return t[a]||t["@@iterator"]||r[o(t)]}},519:function(t,e,n){var o=n(15)("iterator"),a=!1;try{var r=[7][o]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!a)return!1;var n=!1;try{var r=[7],i=r[o]();i.next=function(){return{done:n=!0}},r[o]=function(){return i},t(r)}catch(t){}return n}},520:function(t,e,n){"use strict";function o(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=a(e),this.reject=a(n)}var a=n(255);t.exports.f=function(t){return new o(t)}},525:function(t,e,n){var o=n(253),a=n(516),r=n(517),i=n(33),s=n(256),c=n(518),d={},l={},e=t.exports=function(t,e,n,u,f){var m,p,v,h,g=f?function(){return t}:c(t),b=o(n,u,e?2:1),y=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(r(g)){for(m=s(t.length);m>y;y++)if((h=e?b(i(p=t[y])[0],p[1]):b(t[y]))===d||h===l)return h}else for(v=g.call(t);!(p=v.next()).done;)if((h=a(v,b,p.value,e))===d||h===l)return h};e.BREAK=d,e.RETURN=l},526:function(t,e,n){var o=n(33),a=n(255),r=n(15)("species");t.exports=function(t,e){var n,i=o(t).constructor;return void 0===i||void 0==(n=o(i)[r])?e:a(n)}},527:function(t,e,n){var o,a,r,i=n(253),s=n(540),c=n(264),d=n(89),l=n(9),u=l.process,f=l.setImmediate,m=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,h=0,g={},b=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},y=function(t){b.call(t.data)};f&&m||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++h]=function(){s("function"==typeof t?t:Function(t),e)},o(h),h},m=function(t){delete g[t]},"process"==n(87)(u)?o=function(t){u.nextTick(i(b,t,1))}:v&&v.now?o=function(t){v.now(i(b,t,1))}:p?(a=new p,r=a.port2,a.port1.onmessage=y,o=i(r.postMessage,r,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(o=function(t){l.postMessage(t+"","*")},l.addEventListener("message",y,!1)):o="onreadystatechange"in d("script")?function(t){c.appendChild(d("script")).onreadystatechange=function(){c.removeChild(this),b.call(t)}}:function(t){setTimeout(i(b,t,1),0)}),t.exports={set:f,clear:m}},528:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},529:function(t,e,n){var o=n(33),a=n(35),r=n(520);t.exports=function(t,e){if(o(t),a(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},530:function(t,e,n){"use strict";var o=n(34);e.a={getUserByEmail:function(t){return o.a.http.get("user/getuser/"+t)},updateUserSettings:function(t){return o.a.http.post("user/updateusersettings",t)},updateUserInformation:function(t){return o.a.http.post("user/updateuserinformation",t)},updateUserEmail:function(t){return o.a.http.post("user/updateuseremail",t)},updateUserPassword:function(t){return o.a.http.post("user/updateuserpassword",t)},completeTutorialTour:function(t){return o.a.http.post("user/completetutorialtour",t)},addCorrectedAddress:function(t){return o.a.http.post("user/addcorrectedaddress",t)},deleteCorrectedAddress:function(t){return o.a.http.post("user/deletecorrectedaddress",t)}}},531:function(t,e){t.exports=function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!");return t}},532:function(t,e,n){var o=n(18);t.exports=function(t,e,n){for(var a in e)n&&t[a]?t[a]=e[a]:o(t,a,e[a]);return t}},537:function(t,e,n){t.exports={default:n(538),__esModule:!0}},538:function(t,e,n){n(262),n(258),n(261),n(539),n(543),n(544),t.exports=n(32).Promise},539:function(t,e,n){"use strict";var o,a,r,i,s=n(50),c=n(9),d=n(253),l=n(500),u=n(86),f=n(35),m=n(255),p=n(531),v=n(525),h=n(526),g=n(527).set,b=n(541)(),y=n(520),_=n(528),x=n(529),C=c.TypeError,A=c.process,w=c.Promise,q="process"==l(A),D=function(){},$=a=y.f,k=!!function(){try{var t=w.resolve(1),e=(t.constructor={})[n(15)("species")]=function(t){t(D,D)};return(q||"function"==typeof PromiseRejectionEvent)&&t.then(D)instanceof e}catch(t){}}(),P=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;b(function(){for(var o=t._v,a=1==t._s,r=0;n.length>r;)!function(e){var n,r,i=a?e.ok:e.fail,s=e.resolve,c=e.reject,d=e.domain;try{i?(a||(2==t._h&&j(t),t._h=1),!0===i?n=o:(d&&d.enter(),n=i(o),d&&d.exit()),n===e.promise?c(C("Promise-chain cycle")):(r=P(n))?r.call(n,s,c):s(n)):c(o)}catch(t){c(t)}}(n[r++]);t._c=[],t._n=!1,e&&!t._h&&S(t)})}},S=function(t){g.call(c,function(){var e,n,o,a=t._v,r=M(t);if(r&&(e=_(function(){q?A.emit("unhandledRejection",a,t):(n=c.onunhandledrejection)?n({promise:t,reason:a}):(o=c.console)&&o.error&&o.error("Unhandled promise rejection",a)}),t._h=q||M(t)?2:1),t._a=void 0,r&&e.e)throw e.v})},M=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,o=0;n.length>o;)if(e=n[o++],e.fail||!M(e.promise))return!1;return!0},j=function(t){g.call(c,function(){var e;q?A.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},I=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},O=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw C("Promise can't be resolved itself");(e=P(t))?b(function(){var o={_w:n,_d:!1};try{e.call(t,d(O,o,1),d(I,o,1))}catch(t){I.call(o,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){I.call({_w:n,_d:!1},t)}}};k||(w=function(t){p(this,w,"Promise","_h"),m(t),o.call(this);try{t(d(O,this,1),d(I,this,1))}catch(t){I.call(this,t)}},o=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},o.prototype=n(532)(w.prototype,{then:function(t,e){var n=$(h(this,w));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=q?A.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new o;this.promise=t,this.resolve=d(O,t,1),this.reject=d(I,t,1)},y.f=$=function(t){return t===w||t===i?new r(t):a(t)}),u(u.G+u.W+u.F*!k,{Promise:w}),n(49)(w,"Promise"),n(542)("Promise"),i=n(32).Promise,u(u.S+u.F*!k,"Promise",{reject:function(t){var e=$(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(s||!k),"Promise",{resolve:function(t){return x(s&&this===i?w:this,t)}}),u(u.S+u.F*!(k&&n(519)(function(t){w.all(t).catch(D)})),"Promise",{all:function(t){var e=this,n=$(e),o=n.resolve,a=n.reject,r=_(function(){var n=[],r=0,i=1;v(t,!1,function(t){var s=r++,c=!1;n.push(void 0),i++,e.resolve(t).then(function(t){c||(c=!0,n[s]=t,--i||o(n))},a)}),--i||o(n)});return r.e&&a(r.v),n.promise},race:function(t){var e=this,n=$(e),o=n.reject,a=_(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return a.e&&o(a.v),n.promise}})},540:function(t,e){t.exports=function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},541:function(t,e,n){var o=n(9),a=n(527).set,r=o.MutationObserver||o.WebKitMutationObserver,i=o.process,s=o.Promise,c="process"==n(87)(i);t.exports=function(){var t,e,n,d=function(){var o,a;for(c&&(o=i.domain)&&o.exit();t;){a=t.fn,t=t.next;try{a()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(c)n=function(){i.nextTick(d)};else if(r){var l=!0,u=document.createTextNode("");new r(d).observe(u,{characterData:!0}),n=function(){u.data=l=!l}}else if(s&&s.resolve){var f=s.resolve();n=function(){f.then(d)}}else n=function(){a.call(o,d)};return function(o){var a={fn:o,next:void 0};e&&(e.next=a),t||(t=a,n()),e=a}}},542:function(t,e,n){"use strict";var o=n(9),a=n(32),r=n(17),i=n(19),s=n(15)("species");t.exports=function(t){var e="function"==typeof a[t]?a[t]:o[t];i&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},543:function(t,e,n){"use strict";var o=n(86),a=n(32),r=n(9),i=n(526),s=n(529);o(o.P+o.R,"Promise",{finally:function(t){var e=i(this,a.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},544:function(t,e,n){"use strict";var o=n(86),a=n(520),r=n(528);o(o.S,"Promise",{try:function(t){var e=a.f(this),n=r(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},545:function(t,e,n){"use strict";var o=n(34);e.a={createConnectionRequest:function(t){return o.a.http.post("connection/createconnectionrequest",t)},cancelConnectionRequest:function(t){return o.a.http.post("connection/cancelconnectionrequest",t)},approveConnectionRequest:function(t){return o.a.http.post("connection/approveconnectionrequest",t)},denyConnectionRequest:function(t){return o.a.http.post("connection/denyconnectionrequest",t)},removeConnection:function(t){return o.a.http.post("connection/removeconnection",t)},disconnectFromBeacon:function(t){return o.a.http.post("connection/disconnectfrombeacon",t)},createConnectionObject:function(t,e,n){return{userId:e._id,beaconId:t._id,beaconOwnerId:t.author._id,lat:t.position.lat,lng:t.position.lng,userLat:n.lat,userLng:n.lng,ownerName:t.author.fullName,name:e.fullName,gravatar:e.gravatar,user:e}}}},546:function(t,e,n){var o=n(547);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(478)("8e915d62",o,!0)},547:function(t,e,n){e=t.exports=n(477)(void 0),e.push([t.i,".connection-square[data-v-7da23f5c]{padding:1rem 1.5rem;color:#0c0c0c;transition:all .3s}.connection-square.map-modal[data-v-7da23f5c]{padding:0;font-size:.85rem}.connection-square[data-v-7da23f5c]:not(.map-modal){cursor:pointer}.connection-square[data-v-7da23f5c]:not(.map-modal):hover{background:#eee}.connection-square div.connection-name[data-v-7da23f5c]{text-overflow:ellipsis;max-width:100%;display:block;overflow:hidden}.connection-square span.connection-timestamp[data-v-7da23f5c]{color:#757575;font-size:90%;margin-top:.2rem}",""])},548:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ConnectionSquare",props:["connection","mapModal"]}},549:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.connection?n("div",{staticClass:"connection-square text-center",class:{"map-modal":t.mapModal}},[n("img",{staticClass:"circular profile",attrs:{src:t.connection.gravatar}}),t._v(" "),n("div",{staticClass:"connection-name"},[t._v(t._s(t.connection.name))]),t._v(" "),t.mapModal?t._e():n("span",{staticClass:"connection-timestamp"},[t._v(t._s(t._f("moment")(t.connection.created,"from","now")))])]):t._e()},staticRenderFns:[]}},567:function(t,e,n){"use strict";var o=n(34);e.a={getCurrentPosition:function(){return o.a.http.post("https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDB7lZd5FSWzgoGMMwnMEVmHPAUeor69MM")},getAddressFromCoordinates:function(t){return o.a.http.post("location/getaddressfromcoordinates",t)},getCoordinatesFromAddress:function(t){return o.a.http.post("location/getcoordinatesfromaddress",t)},getDistanceBetweenCoordinates:function(t){return o.a.http.post("location/getdistancebetweencoordinates",t)},createBeaconDistanceObject:function(t,e){return{lat1:e.lat,lng1:e.lng,lat2:t.position.lat,lng2:t.position.lng}},autocompleteAddress:function(t){return o.a.http.post("location/autocompleteaddress",t)}}},568:function(t,e,n){"use strict";var o=n(34);e.a={lightBeacon:function(t){return o.a.http.post("beacon/lightbeacon",t)},extinguishBeacon:function(t){return o.a.http.post("beacon/extinguishbeacon",t)},getNearbyBeacons:function(t){return o.a.http.post("beacon/getnearbybeacons",t)},verifyBeaconPassword:function(t){return o.a.http.post("beacon/verifybeaconpassword",t)}}},603:function(t,e,n){var o=n(604);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(478)("e55b0bb2",o,!0)},604:function(t,e,n){e=t.exports=n(477)(void 0),e.push([t.i,".beacon-card .beacon-card-title[data-v-d29dab06]{color:#fff}.beacon-card form[data-v-d29dab06]{padding:0 1rem 1.5rem}.beacon-card .connection-body[data-v-d29dab06]{padding:1rem}.beacon-card .connection-text[data-v-d29dab06]{padding:1rem 0}.beacon-card.connection-card[data-v-d29dab06]{margin-top:3rem}.beacon-card.connection-card .no-connections[data-v-d29dab06]{color:#0c0c0c;padding:1rem}.toggle-field[data-v-d29dab06]{padding-top:2rem;padding-bottom:1rem}.additional-settings-wrapper[data-v-d29dab06]{padding-top:1rem}.q-toggle[data-v-d29dab06]{-webkit-transform:scale(3);transform:scale(3)}.additional-settings-modal .modal-body[data-v-d29dab06]{overflow-x:hidden}.additional-settings-modal .q-slider[data-v-d29dab06]{max-width:98%}form.correctAddressForm[data-v-d29dab06]{padding-top:1rem}",""])},605:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(537),a=n.n(o),r=n(263),i=n.n(r),s=n(47),c=n(499),d=(n.n(c),n(567)),l=n(545),u=n(568),f=n(530),m=n(254),p=n(257),v=n(480),h=n.n(v);e.default={name:"Beacon",mixins:[m.a,p.a],components:{QBtn:s.e,QCard:s.f,QCardTitle:s.i,QField:s.p,QInput:s.s,QModal:s.B,QModalLayout:s.C,QRadio:s.E,QRange:s.F,QToggle:s.S,QToolbar:s.T,QChipsInput:s.m,QInnerLoading:s.r,QSpinnerGears:s.L,QSpinner:s.K,QSearch:s.H,QPagination:s.D,QAutocomplete:s.d,QCheckbox:s.k,ConnectionSquare:h.a},data:function(){return{formData:{name:"",description:"",color:this.$store.state.user.settings.defaultColor||"#FF0000",beaconLit:this.doesObjectExist(this.$store.state.user.beacon),location:{type:"Point",coordinates:[]},address:"",author:this.$store.state.user._id,additionalSettings:null},correctAddressData:{address:"",lat:0,lng:0,canUpdateAddress:!1,saveCorrectedAddress:!1},additionalSettings:this.$store.state.user.beacon&&this.$store.state.user.beacon.additionalSettings||{password:null,ageRange:{min:18,max:100},genderRestriction:null,tags:[]},connectedBeacon:null,search:"",page:1,limit:12,minPages:1,loading:!1,addressLoading:!1,correctAddressModalLoading:!1}},computed:{user:function(){return!!this.$store.state.user&&this.$store.state.user},connections:function(){return this.checkExistence(this.$store.state.user,["beacon","connections"])?this.$store.state.user.beacon.connections:[]},filteredConnections:function(){var t=this;return this.connections.filter(function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())})},skip:function(){return this.page*this.limit-this.limit},maxPages:function(){return Math.ceil(this.filteredConnections.length/this.limit)}},validations:{formData:{name:{required:c.required,maxLength:Object(c.maxLength)(100)},description:{required:c.required,maxLength:Object(c.maxLength)(140)},address:{required:c.required,maxLength:Object(c.maxLength)(100)}},additionalSettings:{password:{minLength:Object(c.minLength)(8)},tags:{maxLength:Object(c.maxLength)(5),$each:{maxLength:Object(c.maxLength)(20)}}},correctAddressData:{address:{maxLength:150,canUpdateAddress:function(t){return this.correctAddressData.canUpdateAddress}}}},methods:{getSlice:function(t){return 1===this.page?t.slice(0,10):t.slice(this.skip,this.skip+this.limit)},openRemoveConnectionDialog:function(t){var e=this;s.c.create({title:"Disconnect "+t.name+" from your beacon?",buttons:["Cancel",{label:"Confirm",handler:function(){e.loading=!0,l.a.removeConnection(t).then(function(n){e.loading=!1,e.$store.commit("updateBeacon",n.body);var o={toId:t.userId,toName:t.name,fromId:t.beaconOwnerId,fromName:t.ownerName};e.$socket.emit("removeConnection",o)}).catch(function(t){e.loading=!1,e.createToast("negative",t.body.message)})}}]})},disconnectFromBeacon:function(t){var e=this;this.loading=!0,l.a.disconnectFromBeacon(t).then(function(n){e.loading=!1,e.$store.commit("updateUser",n.body);var o={toId:t.beaconOwnerId,fromId:t.userId,fromName:t.name};e.$socket.emit("disconnectFromBeacon",o)}).catch(function(t){e.loading=!1,e.createToast("negative",t.body.message)})},toggleBeacon:function(){var t=this;if(this.loading=!0,this.formData.userId=this.$store.state.user._id,this.formData.beaconLit)this.$store.state.user.settings.playBeaconSound&&document.getElementById("horn").play(),u.a.lightBeacon(this.formData).then(function(e){t.loading=!1,t.$store.commit("updateUser",e.body),t.$store.commit("updateBeacon",e.body.beacon)}).catch(function(e){t.formData.beaconLit=!1,t.loading=!1,t.createToast("negative",e.body.message)});else{var e=JSON.parse(i()(this.$store.state.user.beacon)),n={beaconId:e._id,userId:e.author};u.a.extinguishBeacon(n).then(function(n){t.loading=!1,t.$store.commit("extinguishBeacon"),t.$store.commit("updateUser",n.body);var o={toIds:e.connections.map(function(t){return t.userId}),fromId:e.author,fromName:t.$store.state.user.fullName};t.$socket.emit("extinguishBeacon",o)}).catch(function(e){t.formData.beaconLit=!0,t.loading=!1,t.createToast("negative",e.body.message)})}},updateAdditionalSettings:function(){this.formData.additionalSettings=this.additionalSettings},checkTagErrors:function(){if(this.$v.additionalSettings.tags.$dirty&&this.$v.additionalSettings.tags.$invalid)return!0;for(var t=0;t<5;t++)if(this.$v.additionalSettings.tags.$each[t]&&this.$v.additionalSettings.tags.$each[t].$invalid)return!0;return!1},cancelConnectionRequest:function(t){var e=this;l.a.cancelConnectionRequest(t).then(function(n){e.$store.commit("updateUser",n.body);var o={toId:t.beaconOwnerId,fromId:t.userId,fromName:t.name};e.$socket.emit("cancelConnectionRequest",o)}).catch(function(t){e.createToast("negative",t.body.message)})},openIncorrectAddressDialog:function(){s.c.create({title:"Incorrect address?",message:"\n          <div>\n          Try these steps:\n          </div>\n          <ol>\n            <li>\n              Verify that your internet connection is wireless. Wired connections are FAR less accurate. Use Wi-fi or mobile data for best results.\n            </li>\n            <li>\n              After verifying that your internet connection is wireless, make sure that your device has a clear path to either your router or a nearby cell tower. Try to avoid being underground or within thick walls.\n            </li>\n          </ol>\n        ",buttons:["Close"]})},getCurrentLocation:function(t){return new a.a(function(e,n){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e({body:{accuracy:t.coords.accuracy,location:{lat:t.coords.latitude,lng:t.coords.longitude}}})},function(o){if(t.$cookie.get("has-seen-geolocation-alert"))d.a.getCurrentPosition().then(function(t){e(t)}).catch(function(t){n(t)});else{var a="";a=1===o.code?"It is HIGHLY recommended to allow your browser to access geolocation. If you choose not to allow access, your location will be far less accurate. Access to geolocation can be changed at any time in your browser settings.":"We were unable to get your location through geolocation. Your location will be less accurate because of this.",s.c.create({title:"Warning",message:a,buttons:[{label:"Confirm",handler:function(){d.a.getCurrentPosition().then(function(n){t.$cookie.set("has-seen-geolocation-alert",!0),e(n)}).catch(function(t){n(t)})}}]})}},{enableHighAccuracy:!0}):d.a.getCurrentPosition().then(function(t){e(t)}).catch(function(t){n(t)})})},correctAddress:function(){var t=this;if(this.correctAddressData.saveCorrectedAddress){this.correctAddressModalLoading=!0;var e={addressChange:{original:{address:this.formData.address,lat:this.formData.location.coordinates[1],lng:this.formData.location.coordinates[0]},corrected:{address:this.correctAddressData.address,lat:this.correctAddressData.lat,lng:this.correctAddressData.lng}},userId:this.$store.state.user._id};f.a.addCorrectedAddress(e).then(function(e){t.correctAddressModalLoading=!1,t.resetCorrectionData(),t.$refs.correctAddressModal.close()}).catch(function(e){t.correctAddressModalLoading=!1,t.createToast("negative",e.body.message)})}else this.resetCorrectionData(),this.$refs.correctAddressModal.close()},getAddresses:function(t,e){var n=this,o={userId:this.$store.state.user._id,address:t};d.a.autocompleteAddress(o).then(function(t){t.body?e(t.body):n.createToast("negative","Could not find the address entered")}).catch(function(){n.createToast("negative","Could not find the address entered")})},selectAddress:function(t){var e=this;this.correctAddressModalLoading=!0;var n={userId:this.$store.state.user._id,address:t.value};d.a.getCoordinatesFromAddress(n).then(function(t){if(t.body){var n={lat1:t.body.lat,lng1:t.body.lng,lat2:e.formData.location.coordinates[1],lng2:e.formData.location.coordinates[0]};e.correctAddressData.lat=t.body.lat,e.correctAddressData.lng=t.body.lng,d.a.getDistanceBetweenCoordinates(n).then(function(t){e.correctAddressModalLoading=!1,t.body&&t.body.canUpdateAddress?e.correctAddressData.canUpdateAddress=!0:e.correctAddressData.canUpdateAddress=!1}).catch(function(){e.correctAddressModalLoading=!1,e.createToast("negative","Could not validate address at this time")})}else e.correctAddressModalLoading=!1,e.createToast("negative","Could not get the coordinates of the address entered")}).catch(function(t){e.correctAddressModalLoading=!1,e.createToast("negative",t.body.message)})},resetCorrectionData:function(){this.formData.location.coordinates=[this.correctAddressData.lng,this.correctAddressData.lat],this.formData.address=this.correctAddressData.address,this.correctAddressData={address:"",lat:0,lng:0,canUpdateAddress:!1,saveCorrectedAddress:!1},this.$v.correctAddressData.$reset()}},mounted:function(){var t=this;this.loading=!0,this.addressLoading=!0,this.doesObjectExist(this.$store.state.user.beacon)&&(this.formData=this.$store.state.user.beacon,this.formData.beaconLit=!0),this.getCurrentLocation(this).then(function(e){t.formData.location.coordinates[0]=e.body.location.lng,t.formData.location.coordinates[1]=e.body.location.lat;var n={lat:e.body.location.lat,lng:e.body.location.lng,userId:t.$store.state.user._id};t.loading=!1,d.a.getAddressFromCoordinates(n).then(function(e){if(t.checkExistence(t.$store.state.user,["beacon","address"]))t.formData.address=t.$store.state.user.beacon.address;else{for(var n=!1,o=0;o<t.$store.state.user.correctedAddresses.length;o++)t.$store.state.user.correctedAddresses[o].original.address===e.body&&(n=t.$store.state.user.correctedAddresses[o].corrected);n?(t.formData.address=n.address,t.formData.location.coordinates[0]=n.lng,t.formData.location.coordinates[1]=n.lat):t.formData.address=e.body,t.addressLoading=!1}t.addressLoading=!1}).catch(function(e){t.createToast("negative",e.body.message),t.addressLoading=!1})}).catch(function(t){this.loading=!1,this.createToast("negative",t.body.message)})}}},606:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout-padding row justify-center"},[n("div",{staticClass:"postlogin-page-wrapper"},[t.checkExistence(t.user,["outgoingConnectionRequest"],!0)&&t.checkExistence(t.user,["connectedTo"],!0)?n("q-card",{staticClass:"beacon-card",attrs:{color:"white"}},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        "+t._s(t.formData.beaconLit?"Extinguish":"Light")+" Beacon\n      ")]),t._v(" "),n("form",{staticClass:"relative-position",attrs:{name:"beaconForm"},on:{submit:function(t){t.preventDefault()}}},[n("q-field",{attrs:{error:t.$v.formData.name.$dirty&&t.$v.formData.name.$invalid,"error-label":"Please enter a name for your beacon"}},[n("q-input",{attrs:{type:"text","max-length":"100","float-label":"Name",disable:t.formData.beaconLit},on:{blur:function(e){t.$v.formData.name.$touch()}},model:{value:t.formData.name,callback:function(e){t.formData.name="string"==typeof e?e.trim():e},expression:"formData.name"}})],1),t._v(" "),n("q-field",{attrs:{error:t.$v.formData.description.$dirty&&t.$v.formData.description.$invalid,"error-label":"Please enter a description for your beacon with a maximum length of 140 characters"}},[n("q-input",{attrs:{type:"textarea","float-label":"Description",disable:t.formData.beaconLit,"max-length":"140","max-height":100,"min-rows":4},on:{blur:function(e){t.$v.formData.description.$touch()}},model:{value:t.formData.description,callback:function(e){t.formData.description="string"==typeof e?e.trim():e},expression:"formData.description"}})],1),t._v(" "),n("q-field",{attrs:{error:t.$v.formData.address.$dirty&&t.$v.formData.address.$invalid,"error-label":"Please enter an address for your beacon"}},[n("q-input",{attrs:{type:"text","max-length":"100",value:t.formData.address,loading:t.addressLoading,"stack-label":t.$store.state.user.settings.showBeaconAddress?"Address":"Address (will not be visible to others)",disable:""}}),t._v(" "),n("small",{staticClass:"incorrect-address"},[n("a",{on:{click:function(e){e.preventDefault(),t.$refs.correctAddressModal.open(e)}}},[t._v("Incorrect address?")])])],1),t._v(" "),n("q-field",{attrs:{label:"Color ("+t.formData.color.toUpperCase()+")",labelWidth:11}}),t._v(" "),n("div",{staticClass:"colorpicker-block",class:{disabled:t.formData.beaconLit}},[n("div",{staticClass:"colorpicker-wrapper relative-position",style:{background:t.formData.color+" !important"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.color,expression:"formData.color"}],staticClass:"full-width colorpicker",attrs:{type:"color",disabled:t.formData.beaconLit},domProps:{value:t.formData.color},on:{input:function(e){e.target.composing||(t.formData.color=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"additional-settings-wrapper text-center"},[n("a",{on:{click:function(e){e.preventDefault(),t.$refs.additionalSettingsModal.open(e)}}},[t._v("Additional settings")])]),t._v(" "),n("q-field",{staticClass:"text-center toggle-field"},[n("q-toggle",{attrs:{disable:t.$v.formData.$invalid},on:{change:t.toggleBeacon},model:{value:t.formData.beaconLit,callback:function(e){t.formData.beaconLit=e},expression:"formData.beaconLit"}})],1),t._v(" "),n("q-inner-loading",{attrs:{visible:t.loading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["outgoingConnectionRequest"])&&t.checkExistence(t.user,["beacon"],!0)?n("q-card",{staticClass:"beacon-card"},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Awaiting Connection Approval\n      ")]),t._v(" "),n("div",{staticClass:"connection-body text-center"},[n("div",[n("q-spinner",{attrs:{color:"primary",size:50}})],1),t._v(" "),n("div",{staticClass:"connection-text"},[t._v("\n          You are currently waiting to be approved by "+t._s(t.$store.state.user.outgoingConnectionRequest.ownerName)+"\n        ")]),t._v(" "),n("q-btn",{attrs:{color:"primary"},on:{click:function(e){e.preventDefault(),t.cancelConnectionRequest(t.$store.state.user.outgoingConnectionRequest)}}},[t._v("Cancel connection request")])],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["outgoingConnectionRequest"],!0)&&t.checkExistence(t.user,["connectedTo"])&&t.checkExistence(t.user,["beacon"],!0)?n("q-card",{staticClass:"beacon-card"},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Connected!\n      ")]),t._v(" "),n("div",{staticClass:"connection-body text-center"},[n("div",{staticClass:"connection-text"},[t._v("\n          You are connected to "+t._s(t.generatePossessive(t.$store.state.user.connectedTo.ownerName))+" beacon\n        ")]),t._v(" "),n("q-btn",{attrs:{color:"primary"},on:{click:function(e){e.preventDefault(),t.disconnectFromBeacon(t.$store.state.user.connectedTo)}}},[t._v("Disconnect")])],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["beacon"])?n("q-card",{staticClass:"beacon-card connection-card relative-position",attrs:{color:"white"}},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Connections\n      ")]),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("q-search",{staticClass:"no-margin",attrs:{color:"primary",inverted:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("div",{staticClass:"row"},t._l(t.getSlice(t.filteredConnections),function(e){return n("connection-square",{key:"connection.userId",staticClass:"col col-lg-4 col-sm-6 col-xs-12",attrs:{connection:e},nativeOn:{click:function(n){t.openRemoveConnectionDialog(e)}}})})):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("div",{staticClass:"text-center"},[n("q-pagination",{attrs:{min:t.minPages,max:t.maxPages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"],!0)?n("div",{staticClass:"text-center no-connections"},[t._v("\n        You have no connections at this time\n      ")]):t._e(),t._v(" "),n("q-inner-loading",{attrs:{visible:t.loading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1):t._e(),t._v(" "),n("q-modal",{ref:"correctAddressModal",staticClass:"footer-no-shadow mobile-modal-padding",attrs:{"content-css":{minWidth:"400px",minHeight:"500px"}}},[n("q-modal-layout",{staticClass:"correctAddressModal"},[n("q-toolbar",{slot:"header"},[n("div",{staticClass:"q-toolbar-title"},[t._v("\n            Correct Your Address\n          ")])]),t._v(" "),n("div",{staticClass:"modal-body"},[n("form",{staticClass:"correctAddressForm",attrs:{name:"correctAddressForm"}},[n("p",[t._v("\n              Please enter your corrected address below. To prevent data falsification, your corrected address must be "),n("strong",[t._v("within 250m")]),t._v(" of the original address.\n            ")]),t._v(" "),n("q-field",{attrs:{error:t.$v.correctAddressData.address.$dirty&&t.$v.correctAddressData.address.$invalid,"error-label":"Corrected address must be within 250m of original address"}},[n("q-input",{ref:"correctAddressInput",attrs:{type:"text","float-label":"Corrected Address",disable:t.formData.beaconLit},on:{blur:function(e){t.$v.correctAddressData.address.$touch()}},model:{value:t.correctAddressData.address,callback:function(e){t.correctAddressData.address="string"==typeof e?e.trim():e},expression:"correctAddressData.address"}},[n("q-autocomplete",{attrs:{"min-characters":3},on:{search:t.getAddresses,selected:t.selectAddress}})],1)],1),t._v(" "),n("q-field",[n("q-checkbox",{attrs:{label:"Save this corrected address so it is always used in place of the original address"},model:{value:t.correctAddressData.saveCorrectedAddress,callback:function(e){t.correctAddressData.saveCorrectedAddress=e},expression:"correctAddressData.saveCorrectedAddress"}})],1)],1)]),t._v(" "),n("q-toolbar",{attrs:{color:"white"},slot:"footer"},[n("div",{staticClass:"q-toolbar-title text-right"},[n("q-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.$refs.correctAddressModal.close()}}},[t._v("Close")]),t._v(" "),n("q-btn",{attrs:{color:"primary",disable:t.$v.correctAddressData.$invalid||!t.correctAddressData.canUpdateAddress||t.formData.beaconLit},on:{click:function(e){t.correctAddress()}}},[t._v("Update Settings")])],1)]),t._v(" "),n("q-inner-loading",{attrs:{visible:t.correctAddressModalLoading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1)],1),t._v(" "),n("q-modal",{ref:"additionalSettingsModal",staticClass:"footer-no-shadow additional-settings-modal mobile-modal-padding",attrs:{"content-css":{minWidth:"400px",minHeight:"500px"}}},[n("q-modal-layout",{staticClass:"additionalSettingsModal"},[n("q-toolbar",{slot:"header"},[n("div",{staticClass:"q-toolbar-title"},[t._v("\n            Additional Settings\n          ")])]),t._v(" "),n("div",{staticClass:"modal-body"},[n("form",{attrs:{name:"additionalSettingsForm"}},[n("q-field",{attrs:{label:"Appear to",labelWidth:11}}),t._v(" "),n("q-radio",{attrs:{val:null,label:"Everyone",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),n("br"),t._v(" "),n("q-radio",{attrs:{val:"maleOnly",label:"Males only",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),n("br"),t._v(" "),n("q-radio",{attrs:{val:"femaleOnly",label:"Females only",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),t._v(" "),n("q-field",{attrs:{label:"Age Range ("+t.additionalSettings.ageRange.min+" to "+t.additionalSettings.ageRange.max+")",labelWidth:11}}),t._v(" "),n("q-range",{attrs:{min:18,max:100,label:"",disable:t.formData.beaconLit},model:{value:t.additionalSettings.ageRange,callback:function(e){t.additionalSettings.ageRange=e},expression:"additionalSettings.ageRange"}}),t._v(" "),n("q-field",{attrs:{error:t.$v.additionalSettings.password.$dirty&&t.$v.additionalSettings.password.$invalid,"error-label":"Password must be at least 8 characters long"}},[n("q-input",{attrs:{type:"password","float-label":"Connection password",disable:t.formData.beaconLit},on:{blur:function(e){t.$v.additionalSettings.password.$touch()}},model:{value:t.additionalSettings.password,callback:function(e){t.additionalSettings.password="string"==typeof e?e.trim():e},expression:"additionalSettings.password"}})],1),t._v(" "),n("q-field",{attrs:{error:t.checkTagErrors(),"error-label":"There is a maximum of 5 tags consisting of 20 characters each"}},[n("q-chips-input",{attrs:{disable:t.formData.beaconLit,"float-label":"Enter up to 5 tags"},model:{value:t.additionalSettings.tags,callback:function(e){t.additionalSettings.tags=e},expression:"additionalSettings.tags"}})],1)],1)]),t._v(" "),n("q-toolbar",{attrs:{color:"white"},slot:"footer"},[n("div",{staticClass:"q-toolbar-title text-right"},[n("q-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.$refs.additionalSettingsModal.close()}}},[t._v("Close")]),t._v(" "),n("q-btn",{attrs:{color:"primary",disable:t.$v.additionalSettings.$invalid||t.formData.beaconLit},on:{click:function(e){t.updateAdditionalSettings(),t.$refs.additionalSettingsModal.close()}}},[t._v("Update Settings")])],1)])],1)],1)],1)])},staticRenderFns:[]}}});