webpackJsonp([13],{489:function(e,t,n){function o(e){n(607)}var i=n(15)(n(609),n(610),o,"data-v-689c6fcf",null);e.exports=i.exports},536:function(e,t,n){"use strict";var o=n(33);t.a={createConnectionRequest:function(e){return o.a.http.post("connection/createconnectionrequest",e)},cancelConnectionRequest:function(e){return o.a.http.post("connection/cancelconnectionrequest",e)},approveConnectionRequest:function(e){return o.a.http.post("connection/approveconnectionrequest",e)},denyConnectionRequest:function(e){return o.a.http.post("connection/denyconnectionrequest",e)},removeConnection:function(e){return o.a.http.post("connection/removeconnection",e)},disconnectFromBeacon:function(e){return o.a.http.post("connection/disconnectfrombeacon",e)},createConnectionObject:function(e,t,n){return{userId:t._id,beaconId:e._id,beaconOwnerId:e.author._id,lat:e.position.lat,lng:e.position.lng,userLat:n.lat,userLng:n.lng,ownerName:e.author.fullName,name:t.fullName,gravatar:t.gravatar,user:t}}}},607:function(e,t,n){var o=n(608);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);n(476)("582e2442",o,!0)},608:function(e,t,n){t=e.exports=n(475)(void 0),t.push([e.i,".q-card.no-beacon i[data-v-689c6fcf]{font-size:4rem}.q-card.no-beacon .beacon-card-title[data-v-689c6fcf]{color:#fff}.q-if-inverted[data-v-689c6fcf]{box-shadow:none;border-radius:0}",""])},609:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(46),i=n(257),a=n(536),c=n(254);t.default={name:"CommunicationInbox",mixins:[i.a,c.a],components:{QBtn:o.d,QList:o.x,QListHeader:o.y,QItem:o.r,QItemSeparator:o.t,QItemSide:o.u,QItemMain:o.s,QItemTile:o.v,QInnerLoading:o.p,QSpinnerGears:o.J,QCard:o.e,QCardTitle:o.h,QField:o.n,QSearch:o.F,QPagination:o.B,QSpinner:o.I},data:function(){return{loading:!1,search:"",page:1,limit:10,minPages:1}},computed:{connectionRequests:function(){return this.checkExistence(this.$store.state.user,["beacon","incomingConnectionRequests"])?this.$store.state.user.beacon.incomingConnectionRequests:[]},filteredRequests:function(){var e=this;return this.connectionRequests.filter(function(t){return t.name.toLowerCase().includes(e.search.toLowerCase())})},skip:function(){return this.page*this.limit-this.limit},maxPages:function(){return Math.ceil(this.filteredRequests.length/this.limit)},user:function(){return!!this.$store.state.user&&this.$store.state.user}},methods:{getSlice:function(e){return 1===this.page?e.slice(0,10):e.slice(this.skip,this.skip+this.limit)},denyConnectionRequest:function(e){var t=this;this.loading=!0,a.a.denyConnectionRequest(e).then(function(n){t.loading=!1,t.$store.commit("updateBeacon",n.body);var o={toId:e.userId,toName:e.name,fromId:e.beaconOwnerId,fromName:e.ownerName};t.$socket.emit("denyConnectionRequest",o)}).catch(function(e){t.loading=!1,t.createToast("negative",e.body.message)})},approveConnectionRequest:function(e){var t=this;this.loading=!0,a.a.approveConnectionRequest(e).then(function(n){t.loading=!1,t.$store.commit("updateBeacon",n.body);var o={toId:e.userId,toName:e.name,fromId:e.beaconOwnerId,fromName:e.ownerName};t.$socket.emit("approveConnectionRequest",o)}).catch(function(e){t.loading=!1,t.createToast("negative",e.body.message)})}}}},610:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout-padding row justify-center"},[n("div",{staticClass:"postlogin-page-wrapper"},[e.checkExistence(e.user,["beacon"])?n("q-card",{staticClass:"relative-position"},[n("q-card-title",{staticClass:"uppercase color-white text-center block bg-primary",attrs:{color:"white"}},[e._v("\n        Inbox\n      ")]),e._v(" "),e.checkExistence(e.user,["beacon","incomingConnectionRequests"])?n("q-search",{staticClass:"no-margin",attrs:{color:"primary",inverted:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}):e._e(),e._v(" "),n("q-list",{attrs:{separator:""}},[e._l(e.getSlice(e.filteredRequests),function(t){return e.checkExistence(e.user,["beacon","incomingConnectionRequests"])?n("q-item",{key:"request.fullName"},[n("q-item-side",{staticClass:"text-center",attrs:{left:""}},[n("img",{staticClass:"circular profile",attrs:{src:t.gravatar}})]),e._v(" "),n("q-item-main",{staticClass:"text-center",attrs:{label:t.name}},[n("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(e._f("moment")(t.created,"from","now")))])],1),e._v(" "),n("q-item-side",{attrs:{right:""}},[n("q-btn",{staticClass:"text-center icon-button",attrs:{flat:"",color:"positive",icon:"ion-checkmark-round"},on:{click:function(n){n.preventDefault(),e.approveConnectionRequest(t)}}}),e._v(" "),n("q-btn",{staticClass:"no-shadow text-center icon-button",attrs:{flat:"",color:"negative",icon:"ion-close-round"},on:{click:function(n){n.preventDefault(),e.denyConnectionRequest(t)}}})],1)],1):e._e()}),e._v(" "),e.checkExistence(e.user,["beacon","incomingConnectionRequests"],!0)?n("q-item",{staticClass:"text-center"},[n("div",{staticClass:"full-width text-center"},[n("q-spinner",{attrs:{color:"primary",size:50}})],1)]):e._e()],2),e._v(" "),e.checkExistence(e.user,["beacon","incomingConnectionRequests"])?n("div",{staticClass:"text-center"},[n("q-pagination",{attrs:{min:e.minPages,max:e.maxPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1):e._e(),e._v(" "),n("q-inner-loading",{attrs:{visible:e.loading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1):e._e(),e._v(" "),e.checkExistence(e.user,["beacon"],!0)?n("q-card",{staticClass:"beacon-card no-beacon"},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[n("i",{staticClass:"icon ion-flame"}),e._v(" "),n("h6",[e._v("Light your beacon to view connection requests")])])],1):e._e()],1)])},staticRenderFns:[]}}});