webpackJsonp([2,14],{480:function(t,e,n){function o(t){n(546)}var a=n(16)(n(548),n(549),o,"data-v-7da23f5c",null);t.exports=a.exports},490:function(t,e,n){function o(t){n(603)}var a=n(16)(n(605),n(606),o,"data-v-d29dab06",null);t.exports=a.exports},498:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.regex=e.ref=e.len=e.req=e.withParams=void 0;var o=n(502),a=function(t){return t&&t.__esModule?t:{default:t}}(o);e.withParams=a.default;var r=e.req=function(t){if(Array.isArray(t))return!!t.length;if(void 0===t||null===t||!1===t)return!1;if("object"==typeof t){for(var e in t)return!0;return!1}return!!String(t).length};e.len=function(t){return Array.isArray(t)?t.length:"object"==typeof t?Object.keys(t).length:String(t).length},e.ref=function(t,e,n){return"function"==typeof t?t.call(e,n):n[t]},e.regex=function(t,e){return(0,a.default)({type:t},function(t){return!r(t)||e.test(t)})}},499:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.and=e.or=e.url=e.sameAs=e.requiredUnless=e.requiredIf=e.required=e.minLength=e.maxLength=e.email=e.between=e.numeric=e.alphaNum=e.alpha=void 0;var a=n(501),r=o(a),i=n(503),s=o(i),c=n(504),l=o(c),u=n(505),d=o(u),f=n(506),m=o(f),v=n(507),p=o(v),g=n(508),h=o(g),b=n(509),y=o(b),_=n(510),x=o(_),w=n(511),q=o(w),C=n(512),$=o(C),P=n(513),D=o(P),k=n(514),S=o(k),L=n(515),j=o(L);e.alpha=r.default,e.alphaNum=s.default,e.numeric=l.default,e.between=d.default,e.email=m.default,e.maxLength=p.default,e.minLength=h.default,e.required=y.default,e.requiredIf=x.default,e.requiredUnless=q.default,e.sameAs=$.default,e.url=D.default,e.or=S.default,e.and=j.default},500:function(t,e,n){var o=n(87),a=n(15)("toStringTag"),r="Arguments"==o(function(){return arguments}()),i=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=i(e=Object(t),a))?n:r?o(e):"Object"==(s=o(e))&&"function"==typeof e.callee?"Arguments":s}},501:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("alpha",/^[a-zA-Z]*$/)},502:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(259).withParams;e.default=o},503:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("alphaNum",/^[a-zA-Z0-9]*$/)},504:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.regex)("numeric",/^[0-9]*$/)},505:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t,e){return(0,o.withParams)({type:"between",min:t,max:e},function(n){return!(0,o.req)(n)||!/\s/.test(n)&&+t<=+n&&+e>=+n})}},506:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498),a=/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/;e.default=(0,o.regex)("email",a)},507:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"maxLength",max:t},function(e){return!(0,o.req)(e)||(0,o.len)(e)<=t})}},508:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"minLength",min:t},function(e){return!(0,o.req)(e)||(0,o.len)(e)>=t})}},509:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=(0,o.withParams)({type:"required"},o.req)},510:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"requiredIf",prop:t},function(e,n){return!(0,o.ref)(t,this,n)||(0,o.req)(e)})}},511:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"requiredUnless",prop:t},function(e,n){return!!(0,o.ref)(t,this,n)||(0,o.req)(e)})}},512:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(t){return(0,o.withParams)({type:"sameAs",eq:t},function(e,n){return e===(0,o.ref)(t,this,n)})}},513:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498),a=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/;e.default=(0,o.regex)("url",a)},514:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.withParams)({type:"or"},function(){for(var t=this,n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return e.length>0&&e.reduce(function(e,n){return e||n.apply(t,o)},!1)})}},515:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(498);e.default=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.withParams)({type:"and"},function(){for(var t=this,n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return e.length>0&&e.reduce(function(e,n){return e&&n.apply(t,o)},!0)})}},516:function(t,e,n){var o=n(33);t.exports=function(t,e,n,a){try{return a?e(o(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&o(r.call(t)),e}}},517:function(t,e,n){var o=n(48),a=n(15)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||r[a]===t)}},518:function(t,e,n){var o=n(500),a=n(15)("iterator"),r=n(48);t.exports=n(32).getIteratorMethod=function(t){if(void 0!=t)return t[a]||t["@@iterator"]||r[o(t)]}},519:function(t,e,n){var o=n(15)("iterator"),a=!1;try{var r=[7][o]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!a)return!1;var n=!1;try{var r=[7],i=r[o]();i.next=function(){return{done:n=!0}},r[o]=function(){return i},t(r)}catch(t){}return n}},520:function(t,e,n){"use strict";function o(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=a(e),this.reject=a(n)}var a=n(255);t.exports.f=function(t){return new o(t)}},525:function(t,e,n){var o=n(253),a=n(516),r=n(517),i=n(33),s=n(256),c=n(518),l={},u={},e=t.exports=function(t,e,n,d,f){var m,v,p,g,h=f?function(){return t}:c(t),b=o(n,d,e?2:1),y=0;if("function"!=typeof h)throw TypeError(t+" is not iterable!");if(r(h)){for(m=s(t.length);m>y;y++)if((g=e?b(i(v=t[y])[0],v[1]):b(t[y]))===l||g===u)return g}else for(p=h.call(t);!(v=p.next()).done;)if((g=a(p,b,v.value,e))===l||g===u)return g};e.BREAK=l,e.RETURN=u},526:function(t,e,n){var o=n(33),a=n(255),r=n(15)("species");t.exports=function(t,e){var n,i=o(t).constructor;return void 0===i||void 0==(n=o(i)[r])?e:a(n)}},527:function(t,e,n){var o,a,r,i=n(253),s=n(540),c=n(264),l=n(89),u=n(9),d=u.process,f=u.setImmediate,m=u.clearImmediate,v=u.MessageChannel,p=u.Dispatch,g=0,h={},b=function(){var t=+this;if(h.hasOwnProperty(t)){var e=h[t];delete h[t],e()}},y=function(t){b.call(t.data)};f&&m||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return h[++g]=function(){s("function"==typeof t?t:Function(t),e)},o(g),g},m=function(t){delete h[t]},"process"==n(87)(d)?o=function(t){d.nextTick(i(b,t,1))}:p&&p.now?o=function(t){p.now(i(b,t,1))}:v?(a=new v,r=a.port2,a.port1.onmessage=y,o=i(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(o=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):o="onreadystatechange"in l("script")?function(t){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),b.call(t)}}:function(t){setTimeout(i(b,t,1),0)}),t.exports={set:f,clear:m}},528:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},529:function(t,e,n){var o=n(33),a=n(34),r=n(520);t.exports=function(t,e){if(o(t),a(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},530:function(t,e){t.exports=function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!");return t}},531:function(t,e,n){var o=n(18);t.exports=function(t,e,n){for(var a in e)n&&t[a]?t[a]=e[a]:o(t,a,e[a]);return t}},537:function(t,e,n){t.exports={default:n(538),__esModule:!0}},538:function(t,e,n){n(262),n(258),n(261),n(539),n(543),n(544),t.exports=n(32).Promise},539:function(t,e,n){"use strict";var o,a,r,i,s=n(50),c=n(9),l=n(253),u=n(500),d=n(86),f=n(34),m=n(255),v=n(530),p=n(525),g=n(526),h=n(527).set,b=n(541)(),y=n(520),_=n(528),x=n(529),w=c.TypeError,q=c.process,C=c.Promise,$="process"==u(q),P=function(){},D=a=y.f,k=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[n(15)("species")]=function(t){t(P,P)};return($||"function"==typeof PromiseRejectionEvent)&&t.then(P)instanceof e}catch(t){}}(),S=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;b(function(){for(var o=t._v,a=1==t._s,r=0;n.length>r;)!function(e){var n,r,i=a?e.ok:e.fail,s=e.resolve,c=e.reject,l=e.domain;try{i?(a||(2==t._h&&A(t),t._h=1),!0===i?n=o:(l&&l.enter(),n=i(o),l&&l.exit()),n===e.promise?c(w("Promise-chain cycle")):(r=S(n))?r.call(n,s,c):s(n)):c(o)}catch(t){c(t)}}(n[r++]);t._c=[],t._n=!1,e&&!t._h&&j(t)})}},j=function(t){h.call(c,function(){var e,n,o,a=t._v,r=M(t);if(r&&(e=_(function(){$?q.emit("unhandledRejection",a,t):(n=c.onunhandledrejection)?n({promise:t,reason:a}):(o=c.console)&&o.error&&o.error("Unhandled promise rejection",a)}),t._h=$||M(t)?2:1),t._a=void 0,r&&e.e)throw e.v})},M=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,o=0;n.length>o;)if(e=n[o++],e.fail||!M(e.promise))return!1;return!0},A=function(t){h.call(c,function(){var e;$?q.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},O=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},R=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=S(t))?b(function(){var o={_w:n,_d:!1};try{e.call(t,l(R,o,1),l(O,o,1))}catch(t){O.call(o,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){O.call({_w:n,_d:!1},t)}}};k||(C=function(t){v(this,C,"Promise","_h"),m(t),o.call(this);try{t(l(R,this,1),l(O,this,1))}catch(t){O.call(this,t)}},o=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},o.prototype=n(531)(C.prototype,{then:function(t,e){var n=D(g(this,C));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=$?q.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new o;this.promise=t,this.resolve=l(R,t,1),this.reject=l(O,t,1)},y.f=D=function(t){return t===C||t===i?new r(t):a(t)}),d(d.G+d.W+d.F*!k,{Promise:C}),n(49)(C,"Promise"),n(542)("Promise"),i=n(32).Promise,d(d.S+d.F*!k,"Promise",{reject:function(t){var e=D(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(s||!k),"Promise",{resolve:function(t){return x(s&&this===i?C:this,t)}}),d(d.S+d.F*!(k&&n(519)(function(t){C.all(t).catch(P)})),"Promise",{all:function(t){var e=this,n=D(e),o=n.resolve,a=n.reject,r=_(function(){var n=[],r=0,i=1;p(t,!1,function(t){var s=r++,c=!1;n.push(void 0),i++,e.resolve(t).then(function(t){c||(c=!0,n[s]=t,--i||o(n))},a)}),--i||o(n)});return r.e&&a(r.v),n.promise},race:function(t){var e=this,n=D(e),o=n.reject,a=_(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return a.e&&o(a.v),n.promise}})},540:function(t,e){t.exports=function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},541:function(t,e,n){var o=n(9),a=n(527).set,r=o.MutationObserver||o.WebKitMutationObserver,i=o.process,s=o.Promise,c="process"==n(87)(i);t.exports=function(){var t,e,n,l=function(){var o,a;for(c&&(o=i.domain)&&o.exit();t;){a=t.fn,t=t.next;try{a()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(c)n=function(){i.nextTick(l)};else if(r){var u=!0,d=document.createTextNode("");new r(l).observe(d,{characterData:!0}),n=function(){d.data=u=!u}}else if(s&&s.resolve){var f=s.resolve();n=function(){f.then(l)}}else n=function(){a.call(o,l)};return function(o){var a={fn:o,next:void 0};e&&(e.next=a),t||(t=a,n()),e=a}}},542:function(t,e,n){"use strict";var o=n(9),a=n(32),r=n(17),i=n(19),s=n(15)("species");t.exports=function(t){var e="function"==typeof a[t]?a[t]:o[t];i&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},543:function(t,e,n){"use strict";var o=n(86),a=n(32),r=n(9),i=n(526),s=n(529);o(o.P+o.R,"Promise",{finally:function(t){var e=i(this,a.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},544:function(t,e,n){"use strict";var o=n(86),a=n(520),r=n(528);o(o.S,"Promise",{try:function(t){var e=a.f(this),n=r(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},545:function(t,e,n){"use strict";var o=n(35);e.a={createConnectionRequest:function(t){return o.a.http.post("connection/createconnectionrequest",t)},cancelConnectionRequest:function(t){return o.a.http.post("connection/cancelconnectionrequest",t)},approveConnectionRequest:function(t){return o.a.http.post("connection/approveconnectionrequest",t)},denyConnectionRequest:function(t){return o.a.http.post("connection/denyconnectionrequest",t)},removeConnection:function(t){return o.a.http.post("connection/removeconnection",t)},disconnectFromBeacon:function(t){return o.a.http.post("connection/disconnectfrombeacon",t)},createConnectionObject:function(t,e,n){return{userId:e._id,beaconId:t._id,beaconOwnerId:t.author._id,lat:t.position.lat,lng:t.position.lng,userLat:n.lat,userLng:n.lng,ownerName:t.author.fullName,name:e.fullName,gravatar:e.gravatar,user:e}}}},546:function(t,e,n){var o=n(547);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(478)("8e915d62",o,!0)},547:function(t,e,n){e=t.exports=n(477)(void 0),e.push([t.i,".connection-square[data-v-7da23f5c]{padding:1rem 1.5rem;color:#0c0c0c;transition:all .3s}.connection-square.map-modal[data-v-7da23f5c]{padding:0;font-size:.85rem}.connection-square[data-v-7da23f5c]:not(.map-modal){cursor:pointer}.connection-square[data-v-7da23f5c]:not(.map-modal):hover{background:#eee}.connection-square div.connection-name[data-v-7da23f5c]{text-overflow:ellipsis;max-width:100%;display:block;overflow:hidden}.connection-square span.connection-timestamp[data-v-7da23f5c]{color:#757575;font-size:90%;margin-top:.2rem}",""])},548:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ConnectionSquare",props:["connection","mapModal"]}},549:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.connection?n("div",{staticClass:"connection-square text-center",class:{"map-modal":t.mapModal}},[n("img",{staticClass:"circular profile",attrs:{src:t.connection.gravatar}}),t._v(" "),n("div",{staticClass:"connection-name"},[t._v(t._s(t.connection.name))]),t._v(" "),t.mapModal?t._e():n("span",{staticClass:"connection-timestamp"},[t._v(t._s(t._f("moment")(t.connection.created,"from","now")))])]):t._e()},staticRenderFns:[]}},567:function(t,e,n){"use strict";var o=n(35);e.a={getCurrentPosition:function(){return o.a.http.post("https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDB7lZd5FSWzgoGMMwnMEVmHPAUeor69MM")},getAddressFromCoordinates:function(t){return o.a.http.post("location/getaddressfromcoordinates",t)},getDistanceBetweenCoordinates:function(t){return o.a.http.post("location/getdistancebetweencoordinates",t)},createBeaconDistanceObject:function(t,e){return{lat1:e.lat,lng1:e.lng,lat2:t.position.lat,lng2:t.position.lng}}}},568:function(t,e,n){"use strict";var o=n(35);e.a={lightBeacon:function(t){return o.a.http.post("beacon/lightbeacon",t)},extinguishBeacon:function(t){return o.a.http.post("beacon/extinguishbeacon",t)},getNearbyBeacons:function(t){return o.a.http.post("beacon/getnearbybeacons",t)},verifyBeaconPassword:function(t){return o.a.http.post("beacon/verifybeaconpassword",t)}}},603:function(t,e,n){var o=n(604);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(478)("e55b0bb2",o,!0)},604:function(t,e,n){e=t.exports=n(477)(void 0),e.push([t.i,".beacon-card .beacon-card-title[data-v-d29dab06]{color:#fff}.beacon-card form[data-v-d29dab06]{padding:0 1rem 1.5rem}.beacon-card .connection-body[data-v-d29dab06]{padding:1rem}.beacon-card .connection-text[data-v-d29dab06]{padding:1rem 0}.beacon-card.connection-card[data-v-d29dab06]{margin-top:3rem}.beacon-card.connection-card .no-connections[data-v-d29dab06]{color:#0c0c0c;padding:1rem}.toggle-field[data-v-d29dab06]{padding-top:2rem;padding-bottom:1rem}.additional-settings-wrapper[data-v-d29dab06]{padding-top:1rem}.q-toggle[data-v-d29dab06]{-webkit-transform:scale(3);transform:scale(3)}.additional-settings-modal .modal-body[data-v-d29dab06]{overflow-x:hidden}.additional-settings-modal .q-slider[data-v-d29dab06]{max-width:98%}",""])},605:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(537),a=n.n(o),r=n(263),i=n.n(r),s=n(47),c=n(499),l=(n.n(c),n(567)),u=n(545),d=n(568),f=n(254),m=n(257),v=n(480),p=n.n(v);e.default={name:"Beacon",mixins:[f.a,m.a],components:{QBtn:s.c,QCard:s.d,QCardTitle:s.g,QField:s.m,QInput:s.p,QModal:s.y,QModalLayout:s.z,QRadio:s.B,QRange:s.C,QToggle:s.P,QToolbar:s.Q,QChipsInput:s.j,QInnerLoading:s.o,QSpinnerGears:s.I,QSpinner:s.H,QSearch:s.E,QPagination:s.A,ConnectionSquare:p.a},data:function(){return{formData:{name:"",description:"",color:this.$store.state.user.settings.defaultColor||"#FF0000",beaconLit:this.doesObjectExist(this.$store.state.user.beacon),location:{type:"Point",coordinates:[]},address:"",author:this.$store.state.user._id,additionalSettings:null},additionalSettings:this.$store.state.user.beacon&&this.$store.state.user.beacon.additionalSettings||{password:null,ageRange:{min:18,max:100},genderRestriction:null,tags:[]},connectedBeacon:null,search:"",page:1,limit:12,minPages:1,loading:!1,addressLoading:!1}},computed:{user:function(){return!!this.$store.state.user&&this.$store.state.user},connections:function(){return this.checkExistence(this.$store.state.user,["beacon","connections"])?this.$store.state.user.beacon.connections:[]},filteredConnections:function(){var t=this;return this.connections.filter(function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())})},skip:function(){return this.page*this.limit-this.limit},maxPages:function(){return Math.ceil(this.filteredConnections.length/this.limit)}},validations:{formData:{name:{required:c.required,maxLength:Object(c.maxLength)(100)},description:{required:c.required,maxLength:Object(c.maxLength)(140)},address:{required:c.required,maxLength:Object(c.maxLength)(100)}},additionalSettings:{password:{minLength:Object(c.minLength)(8)},tags:{maxLength:Object(c.maxLength)(5),$each:{maxLength:Object(c.maxLength)(20)}}}},methods:{getSlice:function(t){return 1===this.page?t.slice(0,10):t.slice(this.skip,this.skip+this.limit)},openRemoveConnectionDialog:function(t){var e=this;s.b.create({title:"Disconnect "+t.name+" from your beacon?",buttons:["Cancel",{label:"Confirm",handler:function(){e.loading=!0,u.a.removeConnection(t).then(function(n){e.loading=!1,e.$store.commit("updateBeacon",n.body);var o={toId:t.userId,toName:t.name,fromId:t.beaconOwnerId,fromName:t.ownerName};e.$socket.emit("removeConnection",o)}).catch(function(t){e.loading=!1,e.createToast("negative",t.body.message)})}}]})},disconnectFromBeacon:function(t){var e=this;this.loading=!0,u.a.disconnectFromBeacon(t).then(function(n){e.loading=!1,e.$store.commit("updateUser",n.body);var o={toId:t.beaconOwnerId,fromId:t.userId,fromName:t.name};e.$socket.emit("disconnectFromBeacon",o)}).catch(function(t){e.loading=!1,e.createToast("negative",t.body.message)})},toggleBeacon:function(){var t=this;if(this.loading=!0,this.formData.userId=this.$store.state.user._id,this.formData.beaconLit)this.$store.state.user.settings.playBeaconSound&&document.getElementById("horn").play(),d.a.lightBeacon(this.formData).then(function(e){t.loading=!1,t.$store.commit("updateUser",e.body),t.$store.commit("updateBeacon",e.body.beacon)}).catch(function(e){t.formData.beaconLit=!1,t.loading=!1,t.createToast("negative",e.body.message)});else{var e=JSON.parse(i()(this.$store.state.user.beacon)),n={beaconId:e._id,userId:e.author};d.a.extinguishBeacon(n).then(function(n){t.loading=!1,t.$store.commit("extinguishBeacon"),t.$store.commit("updateUser",n.body);var o={toIds:e.connections.map(function(t){return t.userId}),fromId:e.author,fromName:t.$store.state.user.fullName};t.$socket.emit("extinguishBeacon",o)}).catch(function(e){t.formData.beaconLit=!0,t.loading=!1,t.createToast("negative",e.body.message)})}},updateAdditionalSettings:function(){this.formData.additionalSettings=this.additionalSettings},checkTagErrors:function(){if(this.$v.additionalSettings.tags.$dirty&&this.$v.additionalSettings.tags.$invalid)return!0;for(var t=0;t<5;t++)if(this.$v.additionalSettings.tags.$each[t]&&this.$v.additionalSettings.tags.$each[t].$invalid)return!0;return!1},cancelConnectionRequest:function(t){var e=this;u.a.cancelConnectionRequest(t).then(function(n){e.$store.commit("updateUser",n.body);var o={toId:t.beaconOwnerId,fromId:t.userId,fromName:t.name};e.$socket.emit("cancelConnectionRequest",o)}).catch(function(t){e.createToast("negative",t.body.message)})},openIncorrectAddressDialog:function(){s.b.create({title:"Incorrect address?",message:"\n          <div>\n          Try these steps:\n          </div>\n          <ol>\n            <li>\n              Verify that your internet connection is wireless. Wired connections are FAR less accurate. Use Wi-fi or mobile data for best results.\n            </li>\n            <li>\n              After verifying that your internet connection is wireless, make sure that your device has a clear path to either your router or a nearby cell tower. Try to avoid being underground or within thick walls.\n            </li>\n          </ol>\n        ",buttons:["Close"]})},getCurrentLocation:function(t){return new a.a(function(e,n){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e({body:{accuracy:t.coords.accuracy,location:{lat:t.coords.latitude,lng:t.coords.longitude}}})},function(o){if(t.$cookie.get("has-seen-geolocation-alert"))l.a.getCurrentPosition().then(function(t){e(t)}).catch(function(t){n(t)});else{var a="";a=1===o.code?"It is HIGHLY recommended to allow your browser to access geolocation. If you choose not to allow access, your location will be far less accurate. Access to geolocation can be changed at any time in your browser settings.":"We were unable to get your location through geolocation. Your location will be less accurate because of this.",s.b.create({title:"Warning",message:a,buttons:[{label:"Confirm",handler:function(){l.a.getCurrentPosition().then(function(n){t.$cookie.set("has-seen-geolocation-alert",!0),e(n)}).catch(function(t){n(t)})}}]})}},{enableHighAccuracy:!0}):l.a.getCurrentPosition().then(function(t){e(t)}).catch(function(t){n(t)})})}},mounted:function(){var t=this;this.loading=!0,this.addressLoading=!0,this.doesObjectExist(this.$store.state.user.beacon)&&(this.formData=this.$store.state.user.beacon,this.formData.beaconLit=!0),this.getCurrentLocation(this).then(function(e){t.formData.location.coordinates[0]=e.body.location.lng,t.formData.location.coordinates[1]=e.body.location.lat;var n={lat:e.body.location.lat,lng:e.body.location.lng,userId:t.$store.state.user._id};t.loading=!1,l.a.getAddressFromCoordinates(n).then(function(e){t.checkExistence(t.$store.state.user,["beacon","address"])?t.formData.address=t.$store.state.user.beacon.address:t.formData.address=e.body,t.addressLoading=!1}).catch(function(e){t.createToast("negative",e.body.message),t.addressLoading=!1})}).catch(function(t){this.loading=!1,this.createToast("negative",t.body.message)})}}},606:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout-padding row justify-center"},[n("div",{staticClass:"postlogin-page-wrapper"},[t.checkExistence(t.user,["outgoingConnectionRequest"],!0)&&t.checkExistence(t.user,["connectedTo"],!0)?n("q-card",{staticClass:"beacon-card",attrs:{color:"white"}},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        "+t._s(t.formData.beaconLit?"Extinguish":"Light")+" Beacon\n      ")]),t._v(" "),n("form",{staticClass:"relative-position",attrs:{name:"beaconForm"},on:{submit:function(t){t.preventDefault()}}},[n("q-field",{attrs:{error:t.$v.formData.name.$dirty&&t.$v.formData.name.$invalid,"error-label":"Please enter a name for your beacon"}},[n("q-input",{attrs:{type:"text","max-length":"100","float-label":"Name",disable:t.formData.beaconLit},on:{blur:function(e){t.$v.formData.name.$touch()}},model:{value:t.formData.name,callback:function(e){t.formData.name="string"==typeof e?e.trim():e},expression:"formData.name"}})],1),t._v(" "),n("q-field",{attrs:{error:t.$v.formData.description.$dirty&&t.$v.formData.description.$invalid,"error-label":"Please enter a description for your beacon with a maximum length of 140 characters"}},[n("q-input",{attrs:{type:"textarea","float-label":"Description",disable:t.formData.beaconLit,"max-length":"140","max-height":100,"min-rows":4},on:{blur:function(e){t.$v.formData.description.$touch()}},model:{value:t.formData.description,callback:function(e){t.formData.description="string"==typeof e?e.trim():e},expression:"formData.description"}})],1),t._v(" "),n("q-field",{attrs:{error:t.$v.formData.address.$dirty&&t.$v.formData.address.$invalid,"error-label":"Please enter an address for your beacon"}},[n("q-input",{attrs:{type:"text","max-length":"100",value:t.formData.address,loading:t.addressLoading,"stack-label":t.$store.state.user.settings.showBeaconAddress?"Address":"Address (will not be visible to others)",disable:""}}),t._v(" "),n("small",{staticClass:"incorrect-address"},[n("a",{on:{click:function(e){e.preventDefault(),t.openIncorrectAddressDialog()}}},[t._v("Incorrect address?")])])],1),t._v(" "),n("q-field",{attrs:{label:"Color ("+t.formData.color.toUpperCase()+")",labelWidth:11}}),t._v(" "),n("div",{staticClass:"colorpicker-block",class:{disabled:t.formData.beaconLit}},[n("div",{staticClass:"colorpicker-wrapper relative-position",style:{background:t.formData.color+" !important"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.color,expression:"formData.color"}],staticClass:"full-width colorpicker",attrs:{type:"color",disabled:t.formData.beaconLit},domProps:{value:t.formData.color},on:{input:function(e){e.target.composing||(t.formData.color=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"additional-settings-wrapper text-center"},[n("a",{on:{click:function(e){e.preventDefault(),t.$refs.additionalSettingsModal.open()}}},[t._v("Additional settings")])]),t._v(" "),n("q-field",{staticClass:"text-center toggle-field"},[n("q-toggle",{attrs:{disable:t.$v.formData.$invalid},on:{change:t.toggleBeacon},model:{value:t.formData.beaconLit,callback:function(e){t.formData.beaconLit=e},expression:"formData.beaconLit"}})],1),t._v(" "),n("q-inner-loading",{attrs:{visible:t.loading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["outgoingConnectionRequest"])&&t.checkExistence(t.user,["beacon"],!0)?n("q-card",{staticClass:"beacon-card"},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Awaiting Connection Approval\n      ")]),t._v(" "),n("div",{staticClass:"connection-body text-center"},[n("div",[n("q-spinner",{attrs:{color:"primary",size:50}})],1),t._v(" "),n("div",{staticClass:"connection-text"},[t._v("\n          You are currently waiting to be approved by "+t._s(t.$store.state.user.outgoingConnectionRequest.ownerName)+"\n        ")]),t._v(" "),n("q-btn",{attrs:{color:"primary"},on:{click:function(e){e.preventDefault(),t.cancelConnectionRequest(t.$store.state.user.outgoingConnectionRequest)}}},[t._v("Cancel connection request")])],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["outgoingConnectionRequest"],!0)&&t.checkExistence(t.user,["connectedTo"])&&t.checkExistence(t.user,["beacon"],!0)?n("q-card",{staticClass:"beacon-card"},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Connected!\n      ")]),t._v(" "),n("div",{staticClass:"connection-body text-center"},[n("div",{staticClass:"connection-text"},[t._v("\n          You are connected to "+t._s(t.generatePossessive(t.$store.state.user.connectedTo.ownerName))+" beacon\n        ")]),t._v(" "),n("q-btn",{attrs:{color:"primary"},on:{click:function(e){e.preventDefault(),t.disconnectFromBeacon(t.$store.state.user.connectedTo)}}},[t._v("Disconnect")])],1)],1):t._e(),t._v(" "),t.checkExistence(t.user,["beacon"])?n("q-card",{staticClass:"beacon-card connection-card relative-position",attrs:{color:"white"}},[n("q-card-title",{staticClass:"uppercase beacon-card-title text-center block bg-primary"},[t._v("\n        Connections\n      ")]),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("q-search",{staticClass:"no-margin",attrs:{color:"primary",inverted:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("div",{staticClass:"row"},t._l(t.getSlice(t.filteredConnections),function(e){return n("connection-square",{key:"connection.userId",staticClass:"col col-lg-4 col-sm-6 col-xs-12",attrs:{connection:e},nativeOn:{click:function(n){t.openRemoveConnectionDialog(e)}}})})):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"])?n("div",{staticClass:"text-center"},[n("q-pagination",{attrs:{min:t.minPages,max:t.maxPages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e(),t._v(" "),t.checkExistence(t.user,["beacon","connections"],!0)?n("div",{staticClass:"text-center no-connections"},[t._v("\n        You have no connections at this time\n      ")]):t._e(),t._v(" "),n("q-inner-loading",{attrs:{visible:t.loading}},[n("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1):t._e(),t._v(" "),n("q-modal",{ref:"additionalSettingsModal",staticClass:"footer-no-shadow additional-settings-modal mobile-modal-padding",attrs:{"content-css":{minWidth:"400px",minHeight:"500px"}}},[n("q-modal-layout",{staticClass:"additionalSettingsModal"},[n("q-toolbar",{slot:"header"},[n("div",{staticClass:"q-toolbar-title"},[t._v("\n            Additional Settings\n          ")])]),t._v(" "),n("div",{staticClass:"modal-body"},[n("form",{attrs:{name:"additionalSettingsForm"}},[n("q-field",{attrs:{label:"Appear to",labelWidth:11}}),t._v(" "),n("q-radio",{attrs:{val:null,label:"Everyone",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),n("br"),t._v(" "),n("q-radio",{attrs:{val:"maleOnly",label:"Males only",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),n("br"),t._v(" "),n("q-radio",{attrs:{val:"femaleOnly",label:"Females only",disable:t.formData.beaconLit},model:{value:t.additionalSettings.genderRestriction,callback:function(e){t.additionalSettings.genderRestriction=e},expression:"additionalSettings.genderRestriction"}}),t._v(" "),n("q-field",{attrs:{label:"Age Range ("+t.additionalSettings.ageRange.min+" to "+t.additionalSettings.ageRange.max+")",labelWidth:11}}),t._v(" "),n("q-range",{attrs:{min:18,max:100,label:"",disable:t.formData.beaconLit},model:{value:t.additionalSettings.ageRange,callback:function(e){t.additionalSettings.ageRange=e},expression:"additionalSettings.ageRange"}}),t._v(" "),n("q-field",{attrs:{error:t.$v.additionalSettings.password.$dirty&&t.$v.additionalSettings.password.$invalid,"error-label":"Password must be at least 8 characters long"}},[n("q-input",{attrs:{type:"password","float-label":"Connection password",disable:t.formData.beaconLit},on:{blur:function(e){t.$v.additionalSettings.password.$touch()}},model:{value:t.additionalSettings.password,callback:function(e){t.additionalSettings.password="string"==typeof e?e.trim():e},expression:"additionalSettings.password"}})],1),t._v(" "),n("q-field",{attrs:{error:t.checkTagErrors(),"error-label":"There is a maximum of 5 tags consisting of 20 characters each"}},[n("q-chips-input",{attrs:{disable:t.formData.beaconLit,"float-label":"Enter up to 5 tags"},model:{value:t.additionalSettings.tags,callback:function(e){t.additionalSettings.tags=e},expression:"additionalSettings.tags"}})],1)],1)]),t._v(" "),n("q-toolbar",{attrs:{color:"white"},slot:"footer"},[n("div",{staticClass:"q-toolbar-title text-right"},[n("q-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.$refs.additionalSettingsModal.close()}}},[t._v("Close")]),t._v(" "),n("q-btn",{attrs:{color:"primary",disable:t.$v.additionalSettings.$invalid||t.formData.beaconLit},on:{click:function(e){t.updateAdditionalSettings(),t.$refs.additionalSettingsModal.close()}}},[t._v("Update Settings")])],1)])],1)],1)],1)])},staticRenderFns:[]}}});